<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  
  <title>Javascript 整洁之道 | Jojo&#39;s World</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="前端,Frontend,Nodejs,JavaScript" />
  

  <meta name="description" content="Javascript整洁之道简介变量 使用有意义的和声明式的变量名">
<meta property="og:type" content="article">
<meta property="og:title" content="Javascript 整洁之道">
<meta property="og:url" content="http://jocolorful.com/2017/08/22/%E5%89%8D%E7%AB%AF-clean-code-javascript/index.html">
<meta property="og:site_name" content="Jojo&#39;s World">
<meta property="og:description" content="Javascript整洁之道简介变量 使用有意义的和声明式的变量名">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2017-08-22T02:16:58.000Z">
<meta property="article:modified_time" content="2024-08-15T14:54:44.788Z">
<meta property="article:author" content="Jojo">
<meta name="twitter:card" content="summary">

  

  
    <link rel="icon" href="/images/avatar.jpg">
  

  <link href="/css/styles.css?v=c114cbeddx" rel="stylesheet">


  
    
<link rel="stylesheet" href="/css/personal-style.css">

  

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-38189205-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?57e94d016e201fba3603a8a2b0263af0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  
  <script type="text/javascript">
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
  </script>



<meta name="generator" content="Hexo 7.1.1"></head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">盒子</span>
  

  
  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Javascript%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93"><span class="toc-text">Javascript整洁之道</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-text">变量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-text">函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%92%8C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-text">对象和数据结构</span></a></li></ol></li></ol>
  </div>



<div class="content content-post LEFT">
   <article id="post-前端-clean-code-javascript" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">Javascript 整洁之道</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2017.08.22</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>Jojo</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a>
  </span>



      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      
      
    </div>
  </header>

  <div class="article-content">
    
      <h1 id="Javascript整洁之道"><a href="#Javascript整洁之道" class="headerlink" title="Javascript整洁之道"></a>Javascript整洁之道</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><ol>
<li>使用有意义的和声明式的变量名</li>
</ol>
<span id="more"></span>

<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> yyyymmdstr = moment.<span class="title function_">format</span>(<span class="string">&#x27;YYYY/MM/DD&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> currentDate = moment.<span class="title function_">format</span>(<span class="string">&#x27;YYYY/MM/DD&#x27;</span>);</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>对同样的变量类型使用相同的词汇</li>
</ol>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">getUserInfo</span>();</span><br><span class="line"><span class="title function_">getClientData</span>();</span><br><span class="line"><span class="title function_">getCustomerRecord</span>();</span><br></pre></td></tr></table></figure>
<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">getUser</span>();</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>使用可检索的变量名<br>我们读的代码多于写的代码。所以代码的课可读性和可检索性非常重要。使用无意义的变量命名会为我们理解程序带来一定的困难。请确保你的变量名可搜索。类似于<a target="_blank" rel="noopener" href="https://github.com/danielstjules/buddy.js">buddy.js</a>和<a target="_blank" rel="noopener" href="https://github.com/eslint/eslint/blob/660e0918933e6e7fede26bc675a0763a6b357c94/docs/rules/no-magic-numbers.md">ESLint</a>可以检查这些没有命名的常量</li>
</ol>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//864000000到底是什么意思</span></span><br><span class="line"><span class="built_in">setTimeout</span>(blastOff, <span class="number">86400000</span>);</span><br></pre></td></tr></table></figure>

<p><font style="font-weight:bold">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//将它声明为常量</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">MILLSECONDS_IN_A_DAY</span> = <span class="number">86400000</span>;</span><br><span class="line"><span class="built_in">setTimeout</span>(blastOff, <span class="variable constant_">MILLSECONDS_IN_A_DAY</span>);</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>使用解释性的变量</li>
</ol>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> address = <span class="string">&#x27;One Infinite Loop , Cupertino 95014&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> cityZipCodeRegex = <span class="regexp">/^[^,\\]+[,\\\s]+(.+?)\s*(\d&#123;5&#125;)?$/</span>;</span><br><span class="line"><span class="title function_">saveCityZipCode</span>(address.<span class="title function_">match</span>(cityZipCodeRegex)[<span class="number">1</span>], address.<span class="title function_">match</span>(cityZipCodeRegex)[<span class="number">2</span>]);</span><br></pre></td></tr></table></figure>

<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> address = <span class="string">&#x27;One Infinite Loop, Cupertino 95014&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> cityZipCodeRegex = <span class="regexp">/^[^,\\]+[,\\\s]+(.+?)\s*(\d&#123;5&#125;)?$/</span>;</span><br><span class="line"><span class="comment">//利用数组的解构，返回的变量</span></span><br><span class="line"><span class="keyword">const</span> [, city, zipCode] = address.<span class="title function_">match</span>(cityZipCodeRegex) || [];</span><br><span class="line"><span class="title function_">saveCityZipCode</span>(city, zipCode);</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>详诉优于概述</li>
</ol>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> locations = [<span class="string">&#x27;Austin&#x27;</span>, <span class="string">&#x27;New York&#x27;</span>, <span class="string">&#x27;San Francisco&#x27;</span>];</span><br><span class="line">      locations.<span class="title function_">forEach</span>(<span class="function">(<span class="params">l</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">doStuff</span>();</span><br><span class="line">      <span class="title function_">doSomeOtherStuff</span>();</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">      <span class="comment">// Wait, what is `l` for again?</span></span><br><span class="line">      <span class="title function_">dispatch</span>(l);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> locations = [<span class="string">&#x27;Austin&#x27;</span>, <span class="string">&#x27;New York&#x27;</span>, <span class="string">&#x27;San Francisco&#x27;</span>];</span><br><span class="line">      locations.<span class="title function_">forEach</span>(<span class="function">(<span class="params">location</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">doStuff</span>();</span><br><span class="line">      <span class="title function_">doSomeOtherStuff</span>();</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">      <span class="title function_">dispatch</span>(location);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>不要增加不需要的上下文</li>
</ol>
<p>如果你的类或者对象已经有语义，不用在变量名中重复这些</p>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Car</span> = &#123;</span><br><span class="line">    <span class="attr">carMake</span>: <span class="string">&#x27;Honda&#x27;</span>,</span><br><span class="line">    <span class="attr">carModel</span>: <span class="string">&#x27;Accord&#x27;</span>,</span><br><span class="line">    <span class="attr">carColor</span>: <span class="string">&#x27;Blue&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">paintCar</span>(<span class="params">car</span>) &#123;</span><br><span class="line">    car.<span class="property">carColor</span> = <span class="string">&#x27;Red&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Car</span> = &#123;</span><br><span class="line">    <span class="attr">make</span>: <span class="string">&#x27;Honda&#x27;</span>,</span><br><span class="line">    <span class="attr">model</span>: <span class="string">&#x27;Accord&#x27;</span>,</span><br><span class="line">    <span class="attr">color</span>: <span class="string">&#x27;Blue&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">paintCar</span>(<span class="params">car</span>) &#123;</span><br><span class="line">    car.<span class="property">color</span> = <span class="string">&#x27;Red&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>使用默认参数代替短路判读或者条件判断</li>
</ol>
<blockquote>
<p>默认的参数总是比短路赋值活着条件语句更加简洁。注意，你使用他们的时候，你的函数将会为未定义的参数提供一个默认值。其他的错误的值，类似于‘’、”“、false、null、0、and NAN将不会被默认值取代</p>
</blockquote>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createMicrobrewery</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> breweryName = name || <span class="string">&#x27;Hipster Brew Co.&#x27;</span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createMicrobrewery</span>(<span class="params">breweryName = <span class="string">&#x27;Hipster Brew Co.&#x27;</span></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><ol>
<li>函数参数:</li>
</ol>
<p>理想情况下：两个或者更少。减少函数的参数越来越重要了，因为它会让你测试你的函数变得简单。拥有超过三个的参数会导致你的函数的测试用例爆炸式地增加（这么强&#x3D;.&#x3D;）.</p>
<p>一个或者两个参数是理想的情况，三个就应该避免。超过三个就应该整合一下。通常， 如果你有超过两个以上的参数，你的函数就会尝试着做很多的事。大多数情况下，一个高阶的对象作为一个参数就满足了。</p>
<p>因为在js中，什么都是对象。没有类的样板。如果你需要一大串参数，你可以使用对象。</p>
<p>为了使函数期望的类型更加明显，你可以使用ES2015&#x2F;ES6的解构语法，它有几点好处：</p>
<ul>
<li><p>当某人一旦看到这个函数声明，就会明白什么属性会被用到。</p>
</li>
<li><p>解构同样克隆参数对象的一些基本类型的值给函数，这个可以排除一些副作用。注意：对象和数组从函数参数对象中不会被克隆</p>
</li>
<li><p>Linter 也可以警告你什么属性没有被用到。哪个属性将不会被解构</p>
</li>
</ul>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createMenu</span>(<span class="params">title, body, buttonText, cancellable</span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createMenu</span>(<span class="params">&#123; title, body, buttonText, cancellable &#125;</span>) &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">createMenu</span>(&#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&#x27;Foo&#x27;</span>,</span><br><span class="line">  <span class="attr">body</span>: <span class="string">&#x27;Bar&#x27;</span>,</span><br><span class="line">  <span class="attr">buttonText</span>: <span class="string">&#x27;Baz&#x27;</span>,</span><br><span class="line">  <span class="attr">cancellable</span>: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>函数应该只做一件事</li>
</ol>
<p>这是软件工程最重要的事，当函数做的事超过了一件。它们会变得越来越难以维护、测试。当你的函数从只做一件事脱离出来，它们可以轻易地被重构，你的代码可读性也会变得很高。</p>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">emailClients</span>(<span class="params">clients</span>) &#123;</span><br><span class="line">    clients.<span class="title function_">forEach</span>(<span class="function">(<span class="params">client</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> clientRecord = database.<span class="title function_">lookup</span>(client);</span><br><span class="line">            <span class="keyword">if</span> (clientRecord.<span class="title function_">isActive</span>()) &#123;</span><br><span class="line">                <span class="title function_">email</span>(client);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">emailActiveClients</span>(<span class="params">clients</span>) &#123;</span><br><span class="line">  clients.<span class="title function_">filter</span>(isActiveClient)</span><br><span class="line">  .<span class="title function_">forEach</span>(email);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isActiveClient</span>(<span class="params">client</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> clientRecord = database.<span class="title function_">lookup</span>(client);</span><br><span class="line">    <span class="keyword">return</span> clientRecord.<span class="title function_">isActive</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>函数名应该告诉他们在做什么</li>
</ol>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addToDate</span>(<span class="params">date, month</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">  <span class="comment">// 难以从函数名分辨出什么被添加了</span></span><br><span class="line"><span class="title function_">addToDate</span>(date, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addMonthToDate</span>(<span class="params">month, date</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"><span class="title function_">addMonthToDate</span>(<span class="number">1</span>, date);</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>函数应该只有一个级别的抽象</li>
</ol>
<blockquote>
<p>当函数有多个级别的抽象时，分割函数可以使代码可读和更容易测试。</p>
</blockquote>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">parseBetterJSAlternative</span>(<span class="params">code</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="variable constant_">REGEXES</span> = [];</span><br><span class="line">  <span class="keyword">const</span> statements = code.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> tokens = [];</span><br><span class="line">  <span class="variable constant_">REGEXES</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">REGEX</span>) =&gt;</span> &#123;</span><br><span class="line">    statements.<span class="title function_">forEach</span>(<span class="function">(<span class="params">statement</span>) =&gt;</span> &#123;<span class="comment">// ...&#125;);</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">const</span> ast = [];</span><br><span class="line">  tokens.<span class="title function_">forEach</span>(<span class="function">(<span class="params">token</span>) =&gt;</span> &#123;<span class="comment">// lex...&#125;);</span></span><br><span class="line">  ast.<span class="title function_">forEach</span>(<span class="function">(<span class="params">node</span>) =&gt;</span> &#123;<span class="comment">// parse...&#125;);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">tokenize</span>(<span class="params">code</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">REGEXES</span> = [<span class="comment">// ...];</span></span><br><span class="line">    <span class="keyword">const</span> statements = code.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> tokens = [];</span><br><span class="line">    <span class="variable constant_">REGEXES</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">REGEX</span>) =&gt;</span> &#123;</span><br><span class="line">        statements.<span class="title function_">forEach</span>(<span class="function">(<span class="params">statement</span>) =&gt;</span> &#123; tokens.<span class="title function_">push</span>( <span class="comment">/* ... */</span> );&#125;);&#125;);</span><br><span class="line">        <span class="keyword">return</span> tokens;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">lexer</span>(<span class="params">tokens</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> ast = [];</span><br><span class="line">        tokens.<span class="title function_">forEach</span>(<span class="function">(<span class="params">token</span>) =&gt;</span> &#123; ast.<span class="title function_">push</span>( <span class="comment">/* ... */</span> );&#125;);</span><br><span class="line">        <span class="keyword">return</span> ast;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">parseBetterJSAlternative</span>(<span class="params">code</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> tokens = <span class="title function_">tokenize</span>(code);</span><br><span class="line">  <span class="keyword">const</span> ast = <span class="title function_">lexer</span>(tokens);</span><br><span class="line">  ast.<span class="title function_">forEach</span>(<span class="function">(<span class="params">node</span>) =&gt;</span> &#123;<span class="comment">// parse...&#125;);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>去掉重复的代码</li>
</ol>
<p>尽量不要复制代码。复制的代码意味着当你修改一个逻辑时，需要更改多个逻辑。假设你经营着一家餐馆，你的库存有的番茄，洋葱，咖喱等等。当你的多张库存表单都有这些东西，当上了一道菜之后，所有的库存表单都需要更新。如果你只有一张表，你就只需要更新一张表。</p>
<p>很多时候，你复制代码因为你有两个或多个不同细微的东西。他们分享了很多共同的东西，但是它们迫使你分离两个或者更多的函数，但是却做着同样的事情。删除一些重复的代码意味着创造出抽象的部分，只用函数&#x2F;模块&#x2F;类来解决一系列的问题。</p>
<p>让抽象的部分做正确的工作是至关重要的。不要重复你自己，否则你会发现你自己你想改变一个地方的时候需要更新很多地方。</p>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">showDeveloperList</span>(<span class="params">developers&#123;developers.forEach((developer) =&gt; &#123;</span></span><br><span class="line"><span class="params">  <span class="keyword">const</span> expectedSalary = developer.calculateExpectedSalary();</span></span><br><span class="line"><span class="params">  <span class="keyword">const</span> experience = developer.getExperience();</span></span><br><span class="line"><span class="params">  <span class="keyword">const</span> githubLink = developer.getGithubLink();</span></span><br><span class="line"><span class="params">  <span class="keyword">const</span> data = &#123;</span></span><br><span class="line"><span class="params">    expectedSalary,</span></span><br><span class="line"><span class="params">    experience,</span></span><br><span class="line"><span class="params">    githubLink</span></span><br><span class="line"><span class="params">  &#125;;</span></span><br><span class="line"><span class="params">  render(data););</span></span><br><span class="line"><span class="params">&#125;</span></span><br><span class="line"><span class="params"></span></span><br><span class="line"><span class="params"><span class="keyword">function</span> showManagerList(managers) &#123;</span></span><br><span class="line"><span class="params">  managers.forEach((manager) =&gt; &#123;</span></span><br><span class="line"><span class="params">    <span class="keyword">const</span> expectedSalary = manager.calculateExpectedSalary();</span></span><br><span class="line"><span class="params">    <span class="keyword">const</span> experience = manager.getExperience();</span></span><br><span class="line"><span class="params">    <span class="keyword">const</span> portfolio = manager.getMBAProjects();</span></span><br><span class="line"><span class="params">    <span class="keyword">const</span> data = &#123;</span></span><br><span class="line"><span class="params">      expectedSalary,</span></span><br><span class="line"><span class="params">      experience,</span></span><br><span class="line"><span class="params">      portfolio</span></span><br><span class="line"><span class="params">    &#125;;</span></span><br><span class="line"><span class="params">    render(data);</span></span><br><span class="line"><span class="params">  &#125;);</span></span><br><span class="line"><span class="params">&#125;</span></span><br></pre></td></tr></table></figure>

<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">showEmployeeList</span>(<span class="params">employees</span>) &#123;</span><br><span class="line">    employees.<span class="title function_">forEach</span>(<span class="function">(<span class="params">employee</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> expectedSalary = employee.<span class="title function_">calculateExpectedSalary</span>();</span><br><span class="line">        <span class="keyword">const</span> experience = employee.<span class="title function_">getExperience</span>();</span><br><span class="line">        <span class="keyword">const</span> data = &#123;</span><br><span class="line">              expectedSalary,</span><br><span class="line">              experience</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">switch</span> (employee.<span class="property">type</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;manager&#x27;</span>:</span><br><span class="line">            data.<span class="property">portfolio</span> = employee.<span class="title function_">getMBAProjects</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;developer&#x27;</span>:</span><br><span class="line">            data.<span class="property">githubLink</span> = employee.<span class="title function_">getGithubLink</span>();</span><br><span class="line">        <span class="keyword">break</span>    ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">render</span>(data);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>为 Object.assign 设置默认的对象</li>
</ol>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> menuConfig = &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">body</span>: <span class="string">&#x27;Bar&#x27;</span>,</span><br><span class="line">    <span class="attr">buttonText</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">cancellable</span>: <span class="literal">true</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createMenu</span>(<span class="params">config</span>) &#123;</span><br><span class="line">    config.<span class="property">title</span> = config.<span class="property">title</span> || <span class="string">&#x27;Foo&#x27;</span>;</span><br><span class="line">    config.<span class="property">body</span> = config.<span class="property">body</span> || <span class="string">&#x27;Bar&#x27;</span>;</span><br><span class="line">    config.<span class="property">buttonText</span> = config.<span class="property">buttonText</span> || <span class="string">&#x27;Baz&#x27;</span>;</span><br><span class="line">    config.<span class="property">cancellable</span> = config.<span class="property">cancellable</span> !== <span class="literal">undefined</span> ? config.<span class="property">cancellable</span> : <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">createMenu</span>(menuConfig);</span><br></pre></td></tr></table></figure>
<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> menuConfig = &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;Order&#x27;</span>,</span><br><span class="line">    <span class="comment">// User did not include &#x27;body&#x27; key</span></span><br><span class="line">    <span class="attr">buttonText</span>: <span class="string">&#x27;Send&#x27;</span>,</span><br><span class="line">    <span class="attr">cancellable</span>: <span class="literal">true</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createMenu</span>(<span class="params">config</span>) &#123;</span><br><span class="line">    config = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&#x27;Foo&#x27;</span>,</span><br><span class="line">        <span class="attr">body</span>: <span class="string">&#x27;Bar&#x27;</span>,</span><br><span class="line">        <span class="attr">buttonText</span>: <span class="string">&#x27;Baz&#x27;</span>,</span><br><span class="line">        <span class="attr">cancellable</span>: <span class="literal">true</span>&#125;, config);</span><br><span class="line">        <span class="comment">// config now equals: &#123;title: &quot;Order&quot;, body: &quot;Bar&quot;, buttonText: &quot;Send&quot;, cancellable: true&#125;</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">createMenu</span>(menuConfig);</span><br></pre></td></tr></table></figure>

<ol start="7">
<li>不要将flag设置为函数的参数</li>
</ol>
<p>flag告诉了你的用户，这个函数做了不止一件事情，函数应该只做一件事。如果像下面的代码，路径决定于不同的布尔值，就将它们拆分出来。</p>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createFile</span>(<span class="params">name, temp</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (temp) &#123;</span><br><span class="line">        fs.<span class="title function_">create</span>(<span class="string">`./temp/<span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        fs.<span class="title function_">create</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createFile</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    fs.<span class="title function_">create</span>(name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createTempFile</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="title function_">createFile</span>(<span class="string">`./temp/<span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="8">
<li>避免副作用</li>
</ol>
<ul>
<li><p>一个函数接收了一个参数返回了其他的值或数组。这个副作用可能改变全局变量，或者奇怪地将你口袋里的钱给一个陌生人。</p>
<p> 现在，你确实需要将这些副作用写进你的代码。像之前的例子，你可能会写一个文件。你需要做的是将这些集中起来。不要将几个函数或类写一个特定的文件。一个来写的工作就够了，有且只有一个。</p>
<p> 这个主要的点是在于避免常见的陷阱，比如一些没有结构的对象共享一些状态，使用无数据类型可以被随意赋值，记住将这些副作用集中起来。</p>
</li>
</ul>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 全局的变量将被下面的函数引用</span></span><br><span class="line"><span class="comment">// 如果另外一个函数使用这个名字，现在它会变成一个数组</span></span><br><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;Ryan McDermott&#x27;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">splitIntoFirstAndLastName</span>(<span class="params"></span>) &#123;</span><br><span class="line">    name = name.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">splitIntoFirstAndLastName</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name); <span class="comment">// [&#x27;Ryan&#x27;, &#x27;McDermott&#x27;];</span></span><br></pre></td></tr></table></figure>

<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">splitIntoFirstAndLastName</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> name.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> name = <span class="string">&#x27;Ryan McDermott&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> newName = <span class="title function_">splitIntoFirstAndLastName</span>(name);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name); <span class="comment">// &#x27;Ryan McDermott&#x27;;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(newName); <span class="comment">// [&#x27;Ryan&#x27;, &#x27;McDermott&#x27;];</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>在JS中，基本类型的通过值传递。对象和数组通过引用传递。在这些对象和数组中，如果你改变购物车中的数组，通过购买一些商品，然后其他的函数可能使用被这些影响了的<code>cat</code> 数组。这可能很棒，但是考虑一下情况：</p>
</li>
<li><p>用户点击了购买的按钮, 按钮需要调用一个购买的函数。这个函数可能会发送一个网络请求，然后将购物车的数组发送给服务器。在网络极差的情况下，这个购买函数会不断地发送请求。现在在网络请求真正发送之前，用户突然点击<code>Add to Cart</code>的按钮。这个购买函数将会发送意外的数据，因为它有对这个购物车数组的引用。</p>
</li>
<li><p>一个好的解决思路是<code>addItemToCart</code>函数总是克隆这个<code>cart</code>，编辑它，然后返回克隆。这个保证了没有其他函数保持对这个购物车保持引用，排除了一些意外的影响。</p>
</li>
</ul>
<p>注意：</p>
<ol>
<li><p>这里存在确实想要改变输入框对象的情况，但是当你适应了这种编程方式你会发现这种方式弥足珍贵。为了没有副作用大多数的代码可以被重构。</p>
</li>
<li><p>介于克隆一个大的对象在性能表现上代价非常昂贵。幸运的是在实践中，这不是一个很大的问题。因为有大量的<a target="_blank" rel="noopener" href="https://facebook.github.io/immutable-js/">库</a>允许这种编程方式又快又好。不需要你去手动克隆对象和数组。</p>
</li>
<li><p>不要写全局的函数</p>
</li>
</ol>
<p>污染全局是非常不好的实践，污染全局变量在JavaScript中是一个不好的做法，因为可能会与另一个库冲突，并且使用你的API用户在生产环境中遇到异常之前不会更明智。让我们来想一个例子：如果你想扩展JavaScript的原生的Array，让两个数组显示出不同的diff函数。你可以在Array.prototype上进行扩展，但是可能会与尝试执行相同操作的另一个库冲突。如果其他库只是使用diff来找到数组的第一个和最后一个元素之间的区别呢？这就是为什么只使用ES2015 &#x2F; ES6类并且只是扩展Array全局更好。</p>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">diff</span> = <span class="keyword">function</span> <span class="title function_">diff</span>(<span class="params">comparisonArray</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> hash = <span class="keyword">new</span> <span class="title class_">Set</span>(comparisonArray);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">elem</span> =&gt;</span> !hash.<span class="title function_">has</span>(elem));</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SuperArray</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Array</span> &#123;</span><br><span class="line">    <span class="title function_">diff</span>(<span class="params">comparisonArray</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> hash = <span class="keyword">new</span> <span class="title class_">Set</span>(comparisonArray);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">elem</span> =&gt;</span> !hash.<span class="title function_">has</span>(elem));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="10">
<li>面向函数编程而不要急于编程</li>
</ol>
<p>JavaScript不是像Haskell的函数式编程语言。但是它却有函数式的味道，函数式语言是比较容易干净和测试的。尽你的可能去尝试这种编程方式。</p>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> programmerOutput = [&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Uncle Bobby&#x27;</span>,</span><br><span class="line">    <span class="attr">linesOfCode</span>: <span class="number">500</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Suzie Q&#x27;</span>,</span><br><span class="line">    <span class="attr">linesOfCode</span>: <span class="number">1500</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Jimmy Gosling&#x27;</span>,</span><br><span class="line">    <span class="attr">linesOfCode</span>: <span class="number">150</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;Gracie Hopper&#x27;</span>,</span><br><span class="line">   <span class="attr">linesOfCode</span>: <span class="number">1000</span></span><br><span class="line"> &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> totalOutput = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; programmerOutput.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    totalOutput += programmerOutput[i].<span class="property">linesOfCode</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> programmerOutput = [&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Uncle Bobby&#x27;</span>,</span><br><span class="line">    <span class="attr">linesOfCode</span>: <span class="number">500</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Suzie Q&#x27;</span>,</span><br><span class="line">    <span class="attr">linesOfCode</span>: <span class="number">1500</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Jimmy Gosling&#x27;</span>,</span><br><span class="line">    <span class="attr">linesOfCode</span>: <span class="number">150</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;Gracie Hopper&#x27;</span>,</span><br><span class="line">   <span class="attr">linesOfCode</span>: <span class="number">1000</span></span><br><span class="line"> &#125;</span><br><span class="line">];</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">INITIAL_VALUE</span> = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">const</span> totalOutput = programmerOutput</span><br><span class="line">      .<span class="title function_">map</span>(<span class="function">(<span class="params">programmer</span>) =&gt;</span> programmer.<span class="property">linesOfCode</span>)</span><br><span class="line">      .<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, linesOfCode</span>) =&gt;</span> acc + linesOfCode, <span class="variable constant_">INITIAL_VALUE</span>)；</span><br></pre></td></tr></table></figure>
<ol start="10">
<li>概括条件</li>
</ol>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (fsm.<span class="property">state</span> === <span class="string">&#x27;fetching&#x27;</span> &amp;&amp; <span class="title function_">isEmpty</span>(listNode)) &#123;</span><br><span class="line">     <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">shouldShowSpinner</span>(<span class="params">fsm, listNode</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> fsm.<span class="property">state</span> === <span class="string">&#x27;fetching&#x27;</span> &amp;&amp; <span class="title function_">isEmpty</span>(listNode);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_">shouldShowSpinner</span>(fsmInstance, listNodeInstance)) &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="10">
<li>避免否定条件</li>
</ol>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">isDOMNodeNotPresent</span>(<span class="params">node</span>) &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_">isDOMNodeNotPresent</span>(node)) &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">isDOMNodePresent</span>(<span class="params">node</span>) &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_">isDOMNodePresent</span>(node)) &#123;</span><br><span class="line">       <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="14">
<li>避免多条件</li>
</ol>
<p>这个看起来像是不可完成的任务。<br>当第一次听到这个的时候，人们都会说：「没有 <code>if</code> 我能够做什么？」。<br>这个回答是：「你可以在不同的情况下使用多态完成相同的任务」。</p>
<p>第二个问题通常是：「听起来不错，可是为什么我被希望要求做这个？」。</p>
<p>答案是我们之前学到过的概念：函数只应该做一件事。当你的 <code>class</code> 和 <code>function</code>	有了条件判断，你在告诉你的用户，你的函数在做不止一件事。</p>
<p>记住，函数只做一件事。</p>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Airplane</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="title function_">getCruisingAltitude</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable language_">this</span>.<span class="property">type</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;777&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getMaxAltitude</span>() - <span class="variable language_">this</span>.<span class="title function_">getPassengerCount</span>();</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;Air Force One&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getMaxAltitude</span>();</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;Cessna&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getMaxAltitude</span>() - <span class="variable language_">this</span>.<span class="title function_">getFuelExpenditure</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Airplane</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Boeing777</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Airplane</span> &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">    <span class="title function_">getCruisingAltitude</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getMaxAltitude</span>() - <span class="variable language_">this</span>.<span class="title function_">getPassengerCount</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AirForceOne</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Airplane</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="title function_">getCruisingAltitude</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getMaxAltitude</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cessna</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Airplane</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="title function_">getCruisingAltitude</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getMaxAltitude</span>() - <span class="variable language_">this</span>.<span class="title function_">getFuelExpenditure</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="15">
<li>避免多条件地查询</li>
</ol>
<ul>
<li>JavaScript是无类型的语言，这意味着你可以使用任何类型来作为参数。有时候你会被这种自由反咬一口，然后尝试着在函数中做类型检测。这里有很多方法去避免这种情况，首先要考虑的是现有的API</li>
</ul>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">travelToTexas</span>(<span class="params">vehicle</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (vehicle <span class="keyword">instanceof</span> <span class="title class_">Bicycle</span>) &#123;</span><br><span class="line">        vehicle.<span class="title function_">pedal</span>(<span class="variable language_">this</span>.<span class="property">currentLocation</span>, <span class="keyword">new</span> <span class="title class_">Location</span>(<span class="string">&#x27;texas&#x27;</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (vehicle <span class="keyword">instanceof</span> <span class="title class_">Car</span>) &#123;</span><br><span class="line">        vehicle.<span class="title function_">drive</span>(<span class="variable language_">this</span>.<span class="property">currentLocation</span>, <span class="keyword">new</span> <span class="title class_">Location</span>(<span class="string">&#x27;texas&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Good :</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">travelToTexas</span>(<span class="params">vehicle</span>) &#123;</span><br><span class="line">      vehicle.<span class="title function_">move</span>(<span class="variable language_">this</span>.<span class="property">currentLocation</span>, <span class="keyword">new</span> <span class="title class_">Location</span>(<span class="string">&#x27;texas&#x27;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>如果你使用的是像字符串和整数这种基本类型的值，但是你不使用多态但是依旧感觉到做类型检测很有必要，你可以考虑 <code>TypeScript</code>。他是<code>JavaScript</code>非常卓越的替代品。它提供了在JS语法基础上的静态类型检测。手动检查普通类型的 JavaScript，需要额外多的代码，这种人造的类型安全使代码丧失了可读性。让代码整洁，书写好的测试用例，才会有好的 code  review。否则，用 TypeScript 来弥补这个缺失。</li>
</ul>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">combine</span>(<span class="params">val1, val2</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> val1 === <span class="string">&#x27;number&#x27;</span> &amp;&amp; <span class="keyword">typeof</span> val2 === <span class="string">&#x27;number&#x27;</span> ||</span><br><span class="line">          <span class="keyword">typeof</span> val1 === <span class="string">&#x27;string&#x27;</span> &amp;&amp; <span class="keyword">typeof</span> val2 === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">              <span class="keyword">return</span> val1 + val2;</span><br><span class="line">          &#125;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Must be of type String or Number&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">combine</span>(<span class="params">val1, val2</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> val1 + val2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="16">
<li>不要过度优化<br>现代浏览器在底层运行时做了很多的优化。很多时候你在优化代码只是在浪费时间。这里有很多好的<a target="_blank" rel="noopener" href="https://github.com/petkaantonov/bluebird/wiki/Optimization-killers">资源</a>来查看哪些底层的优化是缺失的。</li>
</ol>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// On old browsers, each iteration with uncached `list.length` would be costly</span></span><br><span class="line"><span class="comment">// because of `list.length` recomputation. In modern browsers, this is optimized.</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, len = list.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; list.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="17">
<li>移除无用的代码<br>无用的代码和复制来的代码一样不好，你的代码库没有理由去保留它。如果没有被调用过，清除它。如果你始终需要它就让它存在在历史版本中。</li>
</ol>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">oldRequestModule</span>(<span class="params">url</span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">newRequestModule</span>(<span class="params">url</span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> req = newRequestModule;</span><br><span class="line"><span class="title function_">inventoryTracker</span>(<span class="string">&#x27;apples&#x27;</span>, req, <span class="string">&#x27;www.inventory-awesome.io&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">newRequestModule</span>(<span class="params">url</span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> req = newRequestModule;</span><br><span class="line"><span class="title function_">inventoryTracker</span>(<span class="string">&#x27;apples&#x27;</span>, req, <span class="string">&#x27;www.inventory-awesome.io&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h2 id="对象和数据结构"><a href="#对象和数据结构" class="headerlink" title="对象和数据结构"></a>对象和数据结构</h2><ol>
<li>使用 getter 和 setter</li>
</ol>
<p><font style="font-weight:bold">Bad:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">makeBankAccount</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">balance</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> account = <span class="title function_">makeBankAccount</span>();</span><br><span class="line">account.<span class="property">balance</span> = <span class="number">100</span>;</span><br></pre></td></tr></table></figure>

<p><font style="font-weight:bold;">Good:</font></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">makeBankAccount</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="comment">//这是一个私有的属性</span></span><br><span class="line">   <span class="keyword">let</span> balance = <span class="number">0</span>;</span><br><span class="line">   <span class="comment">// a &quot;getter&quot;,通过下面的返回对象使之成为公有。</span></span><br><span class="line">   <span class="keyword">function</span> <span class="title function_">getBalance</span>(<span class="params"></span>) &#123;</span><br><span class="line">   		<span class="keyword">return</span> balance;</span><br><span class="line">   &#125;</span><br><span class="line">    <span class="comment">// a &quot;setter&quot;, 通过下面的返回对象使之成为公有。</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">setBalance</span>(<span class="params">amount</span>) &#123;</span><br><span class="line">    	<span class="comment">// ... validate before updating the balance</span></span><br><span class="line">    	balance = amount;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">   	 <span class="comment">// ...</span></span><br><span class="line">    	getBalance,</span><br><span class="line">      setBalance,</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> account = <span class="title function_">makeBankAccount</span>();</span><br><span class="line">account.<span class="title function_">setBalance</span>(<span class="number">100</span>);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>使用 getter 和 setter</li>
</ol>

    
  </div>

</article>

   
  <div class="box-prev-next clearfix">
    <a class="hide pull-left" href="/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2019/01/22/%E5%89%8D%E7%AB%AF-ReactHooks/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              rel="noopener noreferrer"
              target="_self"
              >
              搜索
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/category/"
              rel="noopener noreferrer"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/atom.xml"
              rel="noopener noreferrer"
              target="_self"
              >
              RSS
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    

    

    
    

    

    
    

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
    <div id="comment" class="vcomment" ></div>
    <script>
        var notify = 'false' == true ? true : false;
        var verify = 'true' == true ? true : false;
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
            return GUEST_INFO.indexOf(item) > -1
        });
        guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
        window.valine = new Valine({
            el: '.vcomment',
            notify: notify,
            verify: verify,
            appId: "svQWH7m2962Cn42ZT1mvWnCP-gzGzoHsz",
            appKey: "FvyIr8AWsURL7tzacZHxOE39",
            avatar:'mm',
            placeholder: "Just go go",
            guest_info:guest_info,
            pageSize:'10'
        });
    </script>
  
    

  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"left","width":200,"height":300,"hOffset":90,"vOffset":0},"mobile":{"show":false},"log":false,"tagMode":false});</script></body>
</html>
